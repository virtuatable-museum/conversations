stages:
  - checks

default:
  image: virtuatable/mongo-ruby-ci:1.0.1
  cache:
    key: $(CI_COMMIT_REF_SLUG)
    paths:
      - vendor/ruby
  before_script:
    # Installs the Bundler dependencies to later get gems
    - /bin/bash --login -c "gem install bundler --no-document"
    # Sets the path used for caching purposes, and install dependencies
    - /bin/bash --login -c "bundle config set path vendor/ruby && bundle install"

rspec:
  stage: checks
  script: /bin/bash --login -c "bundle exec rspec"

rubocop:
  stage: checks
  script: bundle exec rubocop